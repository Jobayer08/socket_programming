<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multicast Chat (CCE 314)</title>
<style>
#username { width: 20%; }
#msg { width: 50%; }
button { padding: 5px 10px; }
.msg-line { margin-bottom: 8px; border-bottom: 1px solid #ddd; padding: 5px; }
.meta { color: #666; font-size: 0.9em; }
#messages { height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 5px; margin-top: 10px; }
</style>
</head>
<body>
<h2>Multicast Chat (CCE 314)</h2>

<div>
<input id="username" placeholder="Your name" value="Student" />
<input id="msg" placeholder="Type a message..." />
<button id="sendBtn">Send</button>
</div>

<div id="messages"></div>

<script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
<script>
const socket = io({ transports: ['polling', 'websocket'] });
const messages = document.getElementById('messages');
const sendBtn = document.getElementById('sendBtn');
const msgInput = document.getElementById('msg');
const userInput = document.getElementById('username');

function addMessage(item){
    const line = document.createElement('div'); line.className='msg-line';
    const meta = document.createElement('div'); meta.className='meta'; meta.textContent=`${item.time} â€” ${item.from}`;
    const text = document.createElement('div'); text.textContent=item.text;
    line.appendChild(meta); line.appendChild(text);
    messages.appendChild(line);
    messages.scrollTop = messages.scrollHeight;
}

socket.on('connect',()=>console.log('Connected to server'));
socket.on('message', data => addMessage(data));

function sendMessage(){
    const username = userInput.value || 'Anon';
    const text = msgInput.value.trim();
    if(!text) return;
    socket.emit('send',{username,text});
    msgInput.value='';
}

sendBtn.addEventListener('click', sendMessage);
msgInput.addEventListener('keydown', e => { if(e.key==='Enter') sendMessage(); });
</script>
</body>
</html>
